import{r as a,A as I,j as e,u as N,a as k,P as E}from"./index-Bm2Ggpdo.js";import{F as S,c as p,C as U,P as b,d as A}from"./FirebaseFunctions-p2g6duGG.js";import{L as H,D as T,H as $}from"./Header-YkJBkGj4.js";import"./logo-DKVccEgK.js";function L({TargetProfile:s,FollowerCount:c,setFollowerCount:u,PhotoCount:n}){const o=s.username,t=s==null?void 0:s.docId,i=s.userId,{UserDetail:w}=a.useContext(I),{user:l}=H(w==null?void 0:w.uid),[f,g]=a.useState(null),F=o?o==(l==null?void 0:l.username):!1,[y,h]=a.useState(0),[C,j]=a.useState(0);async function v(){var x,m;g(!f),u({FollowerCount:f?c-1:c+1}),await S(i,l.docId,f,t,l.userId,f);const r=await p(t);h(((x=r==null?void 0:r.followers)==null?void 0:x.length)||0),j(((m=r==null?void 0:r.following)==null?void 0:m.length)||0)}return a.useEffect(()=>{async function d(){const r=await U(l==null?void 0:l.username,i);g(!!r)}l!=null&&l.username&&i&&d()},[l==null?void 0:l.username,i]),a.useEffect(()=>{async function d(){var r,x;if(i){const m=await p(t);h(((r=m==null?void 0:m.followers)==null?void 0:r.length)||0),j(((x=m==null?void 0:m.following)==null?void 0:x.length)||0)}}d()},[s]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:" flex-wrap gap-[2rem] lg:flex flex-row flex-wrap justify-center  mt-8 sm:justify-center flex flex-row sm:ml-5  md:justify-center md:-ml-[25rem]",children:[o?e.jsx("div",{children:e.jsx("img",{className:"h-14 rounded-full w-14",src:`/images/avatars/${o}.jpg`,alt:"",onError:d=>d.target.src=T})}):null,o?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex gap-8",children:[e.jsx("div",{className:"font-black pt-3",children:o}),f==null||F?"":e.jsx("div",{className:"pt-3 ",children:e.jsx("button",{onClick:v,className:`flex font-medium rounded ${f?"pl-[.5rem]":"pl-[1.3rem]"} hover:bg-blue-700  min-w-[5.5rem] min-h-[1.8rem]  border-green-400 bg-[#2563EB] text-white`,children:`${f?"unfollow":"follow"}`})})]})}):null]}),e.jsxs("div",{className:"flex  gap-[2rem] lg:flex flex-row flex-wrap justify-center  mt-5 sm:justify-center flex flex-row sm:ml-[13rem]  md:justify-center md:-ml-[13rem]",children:[e.jsxs("div",{children:[n||"0"," ",e.jsx("span",{children:"Photos"})]}),e.jsxs("div",{children:[y," ",e.jsx("span",{children:"followers"})]}),e.jsxs("div",{children:[C," ",e.jsx("span",{children:"following"})]})]})]})}function B({photoCollection:s}){return console.log("Coming in from PHOTOS to show targetPhotos:",s),e.jsx(e.Fragment,{children:Array.isArray(s)&&s.length>0?e.jsx("div",{className:" flex justify-center",children:e.jsxs("div",{className:"flex-wrap flex gap-[2rem] lg:flex flex-row lg:flex-wrap lg:justify-start lg:-ml-[11rem]  mt-[5rem] sm:justify-center sm:flex sm:flex-row sm:ml-5  md:justify-center md:-ml-[25rem] max-w-[45%] xl:flex xl:justify-start pb-8  ",children:[s==null?void 0:s.map(c=>e.jsx("img",{className:" flex flex wrap w-[30%]",src:c.imageSrc,alt:""},`${c.docId}`)),e.jsx("img",{src:"",alt:""})]})}):null})}function D({ProfileParam:s}){a.useState("");function c(t,i){return{...t,...i}}const u={profile:{},photoCollection:null,followerCount:0},[n,o]=a.useReducer(c,u);return a.useEffect(()=>{async function t(){const i=await b(s==null?void 0:s.userId);o({profile:s,photoCollection:i,followerCount:s.followers.length})}t()},[s.userId]),n?e.jsxs(e.Fragment,{children:[e.jsx(L,{PhotoCount:n.photoCollection?n.photoCollection.length:0,TargetProfile:n.profile,FollowerCount:n.followerCount,setFollowerCount:o}),e.jsx(B,{photoCollection:n.photoCollection})]}):null}function G(){const s=N(),{username:c}=k(),[u,n]=a.useState("");return a.useEffect(()=>{async function o(){const t=await A(c);t!=null&&t.userId?n(t):s(E)}o()},[c,s]),u!=null&&u.username?e.jsxs(e.Fragment,{children:[e.jsx($,{}),e.jsx(D,{ProfileParam:u})]}):null}export{G as default};
